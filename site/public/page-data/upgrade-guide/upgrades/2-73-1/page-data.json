{"componentChunkName":"component---src-templates-step-template-js","path":"/upgrade-guide/upgrades/2-73-1/","result":{"data":{"asciidoc":{"html":"<div class=\"sect3\">\n<h4 id=\"_known_issue_agent_connection_failures_involving_jenkins_controllers_with_undefined_or_non_writable_home_directory\">Known Issue: Agent connection failures involving Jenkins controllers with undefined or non-writable home directory</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-45755\">JENKINS-45755</a></p>\n</div>\n<div class=\"paragraph\">\n<p>A regression involving agent connections has been identified.\nIf the user home directory (<code>HOME</code>, not <code>JENKINS_HOME</code>) on the Jenkins controller is undefined, or not writable, no remoting connections can be established.</p>\n</div>\n<div class=\"paragraph\">\n<p>The following features are known to impacted:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Agent connections</p>\n</li>\n<li>\n<p>Remoting-based CLI connections (deprecated since 2.46.2)</p>\n</li>\n<li>\n<p>Building Maven projects (Maven Integration Plugin)</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>The error shown will include the path to a directory <code>.jenkins/cache/jars</code> inside the home directory, and its stack trace will reference <code>hudson.remoting.FileSystemJarCache</code>.</p>\n</div>\n<div class=\"paragraph\">\n<p>The Jenkins Docker image has been changed to have a defined, writable home directory for the Jenkins user.\nTypical web application container (e.g. Tomcat) setups may not have a writable home directory for the user the container is running as, and may need to be adapted to work around this issue.</p>\n</div>\n<div class=\"paragraph\">\n<p>Possible workarounds:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Make the specified home directory writable to the Jenkins user.</p>\n</li>\n<li>\n<p>Define a home directory that is writable for the user Jenkins is running as.</p>\n</li>\n<li>\n<p>Override it for the process running Jenkins, for example using the <code>-Duser.home=/path/to/directory</code> parameter to the <code>java</code> command, pointing to a writable directory.</p>\n</li>\n</ol>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_known_issue_randomly_occurring_connection_failures_with_passphrase_protected_ed25519_ssh_keys\">Known Issue: Randomly occurring connection failures with passphrase-protected ed25519 SSH keys</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-46754\">JENKINS-46754</a></p>\n</div>\n<div class=\"paragraph\">\n<p>A regression involving authentication using passphrase-protected ed25519 SSH keys has been identified in 2.73.\nIt randomly causes failures in features using these keys, such as:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>SSH Slaves Plugin connections</p>\n</li>\n<li>\n<p>Accessing Git repositories with the JGit implementation</p>\n</li>\n<li>\n<p>Accessing Subversion repositories (unconfirmed)</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>Workarounds for this issue:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Do not use ed25519 for SSH keys in Jenkins</p>\n</li>\n<li>\n<p>Do not protect ed25519 SSH keys in Jenkins with a passphrase</p>\n</li>\n<li>\n<p>In the case of Git Plugin, switch to the Git CLI implementation</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"https://gist.github.com/rtyler/cd3a3f759c46f308bf7151819f5538a0\">This Groovy Script</a>, when executed in the \"Script Console\" (located at <code>/script</code>) can be used to determine if the instance contains any passphrase-proteced ed25519 SSH keys before upgrading.</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_groovy_2_4_11_upgrade\">Groovy 2.4.11 Upgrade</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-43197\">JENKINS-43197</a></p>\n</div>\n<div class=\"paragraph\">\n<p>Groovy was updated from 2.4.8 to 2.4.11.\nThis may resolve existing Groovy-related memory problems, as 2.4.9 contains the fix for <a href=\"https://issues.apache.org/jira/browse/GROOVY-8067\">GROOVY-8067</a>.\nIt may no longer be necessary to apply the <code>groovy.use.classvalue</code> workaround.</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_winstone_4_1_upgrade\">Winstone 4.1 Upgrade</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-43713\">JENKINS-43713</a>,\n<a href=\"https://issues.jenkins.io/browse/JENKINS-46968\">JENKINS-46968</a></p>\n</div>\n<div class=\"paragraph\">\n<p>The embedded Jetty container has been updated from version 9.2.15 to version 9.4.5.\nFor a detailed list of changes, see <a href=\"https://github.com/eclipse/jetty.project/blob/master/VERSION.txt\">the Jetty changelog</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>In this update, support for the optional <code>--spdy</code> parameter has been dropped.\nJenkins will now refuse to start if the <code>---spdy</code> parameter is specified.\nIt needs to be removed from any Jenkins init scripts.</p>\n</div>\n<div class=\"paragraph\">\n<p>Additionally, support for all TLS versions before 1.2 has been dropped.\nIf you&#8217;re using the embedded Jetty container&#8217;s HTTPS functionality, it will no longer accept TLS 1.0 or 1.1 connections.</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_build_authorization\">Build Authorization</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-22949\">JENKINS-22949</a>,\n<a href=\"https://issues.jenkins.io/browse/JENKINS-30574\">JENKINS-30574</a></p>\n</div>\n<div class=\"paragraph\">\n<p>This change affects only users of Authorize Project Plugin.</p>\n</div>\n<div class=\"paragraph\">\n<p>Previous releases of Jenkins implemented a special permission fallback when Authorize Project Plugin did not specify a global default configuration:\nFor the purposes of <strong>Build other projects</strong> and <strong>Build after other projects are built</strong>, if Authorize Project configuration did not specify a build authorization for the job in question, it fell back to acting with the permissions of the <em>anonymous</em> user.\nThis ensured a secure default, but only for these trigger-related permission checks.</p>\n</div>\n<div class=\"paragraph\">\n<p>This behavior has been changed, and Jenkins will now perform the permission check as SYSTEM (i.e. with full permissions) to determine whether a project should be built.</p>\n</div>\n<div class=\"paragraph\">\n<p>To restore the previous behavior, configure a global <strong>Project default Build Authorization</strong> setting the default authorization to that of the anonymous user.\nThis feature has been implemented in Authorize Project Plugin version 1.2.0.</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_remoting_work_directories\">Remoting Work Directories</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-44108\">JENKINS-44108</a>,\n<a href=\"https://issues.jenkins.io/browse/JENKINS-44112\">JENKINS-44112</a></p>\n</div>\n<div class=\"paragraph\">\n<p>The embedded <a href=\"/projects/remoting/\">Jenkins Remoting</a> version has been updated from 3.7 to 3.10.\nIt introduces support of work directories, which may be used by Remoting to store caches, logs and other metadata.</p>\n</div>\n<div class=\"paragraph\">\n<p>Once work directory mode is enabled, Jenkins agents start writing logs to the disk and change the default destination of the filesystem JAR Cache.\nIn Remoting this opt-in feature can be enabled using the <code>-workDir=${ROOT_DIR}</code> command-line option, but the Jenkins defines custom behavior for some agent launchers:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Java Web Start Launcher (aka <em>JNLP agent</em>)</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Old agents: Work directory needs to be enabled manually</p>\n</li>\n<li>\n<p>New agents created from Web UI: Work directory is enabled by default, work directory points to <em>Remote root directory</em> of the agent.</p>\n</li>\n<li>\n<p>New agents created from CLI/API: Behavior depends on the passed configuration file, work directory is disabled by default</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Command Launcher</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>No changes, work directory should be manually enabled in launch settings if required</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Other Launcher types (e.g. SSH Launcher)</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The behavior is defined in plugins, which have independent release cycle</p>\n</li>\n<li>\n<p>Follow updates in tickets linked to <a href=\"https://issues.jenkins.io/browse/JENKINS-44108\">JENKINS-44108</a></p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>You can find more information, examples and upgrade guides in <a href=\"https://github.com/jenkinsci/remoting/blob/master/docs/workDir.md\">Jenkins Remoting documentation</a>.</p>\n</div>\n</div>","document":{"title":"Known Issue: Agent connection failures involving Jenkins controllers with undefined or non-writable home directory","main":"Known Issue"},"author":{"fullName":null},"pageAttributes":{"author_name":null,"author":null,"tags":null,"opengraph":null}}},"pageContext":{"node":{"id":"eacaf21b-ed5c-5a68-adfe-cc10be6b80fc","html":"<div class=\"sect3\">\n<h4 id=\"_known_issue_agent_connection_failures_involving_jenkins_controllers_with_undefined_or_non_writable_home_directory\">Known Issue: Agent connection failures involving Jenkins controllers with undefined or non-writable home directory</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-45755\">JENKINS-45755</a></p>\n</div>\n<div class=\"paragraph\">\n<p>A regression involving agent connections has been identified.\nIf the user home directory (<code>HOME</code>, not <code>JENKINS_HOME</code>) on the Jenkins controller is undefined, or not writable, no remoting connections can be established.</p>\n</div>\n<div class=\"paragraph\">\n<p>The following features are known to impacted:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Agent connections</p>\n</li>\n<li>\n<p>Remoting-based CLI connections (deprecated since 2.46.2)</p>\n</li>\n<li>\n<p>Building Maven projects (Maven Integration Plugin)</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>The error shown will include the path to a directory <code>.jenkins/cache/jars</code> inside the home directory, and its stack trace will reference <code>hudson.remoting.FileSystemJarCache</code>.</p>\n</div>\n<div class=\"paragraph\">\n<p>The Jenkins Docker image has been changed to have a defined, writable home directory for the Jenkins user.\nTypical web application container (e.g. Tomcat) setups may not have a writable home directory for the user the container is running as, and may need to be adapted to work around this issue.</p>\n</div>\n<div class=\"paragraph\">\n<p>Possible workarounds:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Make the specified home directory writable to the Jenkins user.</p>\n</li>\n<li>\n<p>Define a home directory that is writable for the user Jenkins is running as.</p>\n</li>\n<li>\n<p>Override it for the process running Jenkins, for example using the <code>-Duser.home=/path/to/directory</code> parameter to the <code>java</code> command, pointing to a writable directory.</p>\n</li>\n</ol>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_known_issue_randomly_occurring_connection_failures_with_passphrase_protected_ed25519_ssh_keys\">Known Issue: Randomly occurring connection failures with passphrase-protected ed25519 SSH keys</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-46754\">JENKINS-46754</a></p>\n</div>\n<div class=\"paragraph\">\n<p>A regression involving authentication using passphrase-protected ed25519 SSH keys has been identified in 2.73.\nIt randomly causes failures in features using these keys, such as:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>SSH Slaves Plugin connections</p>\n</li>\n<li>\n<p>Accessing Git repositories with the JGit implementation</p>\n</li>\n<li>\n<p>Accessing Subversion repositories (unconfirmed)</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p>Workarounds for this issue:</p>\n</div>\n<div class=\"olist arabic\">\n<ol class=\"arabic\">\n<li>\n<p>Do not use ed25519 for SSH keys in Jenkins</p>\n</li>\n<li>\n<p>Do not protect ed25519 SSH keys in Jenkins with a passphrase</p>\n</li>\n<li>\n<p>In the case of Git Plugin, switch to the Git CLI implementation</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"https://gist.github.com/rtyler/cd3a3f759c46f308bf7151819f5538a0\">This Groovy Script</a>, when executed in the \"Script Console\" (located at <code>/script</code>) can be used to determine if the instance contains any passphrase-proteced ed25519 SSH keys before upgrading.</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_groovy_2_4_11_upgrade\">Groovy 2.4.11 Upgrade</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-43197\">JENKINS-43197</a></p>\n</div>\n<div class=\"paragraph\">\n<p>Groovy was updated from 2.4.8 to 2.4.11.\nThis may resolve existing Groovy-related memory problems, as 2.4.9 contains the fix for <a href=\"https://issues.apache.org/jira/browse/GROOVY-8067\">GROOVY-8067</a>.\nIt may no longer be necessary to apply the <code>groovy.use.classvalue</code> workaround.</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_winstone_4_1_upgrade\">Winstone 4.1 Upgrade</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-43713\">JENKINS-43713</a>,\n<a href=\"https://issues.jenkins.io/browse/JENKINS-46968\">JENKINS-46968</a></p>\n</div>\n<div class=\"paragraph\">\n<p>The embedded Jetty container has been updated from version 9.2.15 to version 9.4.5.\nFor a detailed list of changes, see <a href=\"https://github.com/eclipse/jetty.project/blob/master/VERSION.txt\">the Jetty changelog</a>.</p>\n</div>\n<div class=\"paragraph\">\n<p>In this update, support for the optional <code>--spdy</code> parameter has been dropped.\nJenkins will now refuse to start if the <code>---spdy</code> parameter is specified.\nIt needs to be removed from any Jenkins init scripts.</p>\n</div>\n<div class=\"paragraph\">\n<p>Additionally, support for all TLS versions before 1.2 has been dropped.\nIf you&#8217;re using the embedded Jetty container&#8217;s HTTPS functionality, it will no longer accept TLS 1.0 or 1.1 connections.</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_build_authorization\">Build Authorization</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-22949\">JENKINS-22949</a>,\n<a href=\"https://issues.jenkins.io/browse/JENKINS-30574\">JENKINS-30574</a></p>\n</div>\n<div class=\"paragraph\">\n<p>This change affects only users of Authorize Project Plugin.</p>\n</div>\n<div class=\"paragraph\">\n<p>Previous releases of Jenkins implemented a special permission fallback when Authorize Project Plugin did not specify a global default configuration:\nFor the purposes of <strong>Build other projects</strong> and <strong>Build after other projects are built</strong>, if Authorize Project configuration did not specify a build authorization for the job in question, it fell back to acting with the permissions of the <em>anonymous</em> user.\nThis ensured a secure default, but only for these trigger-related permission checks.</p>\n</div>\n<div class=\"paragraph\">\n<p>This behavior has been changed, and Jenkins will now perform the permission check as SYSTEM (i.e. with full permissions) to determine whether a project should be built.</p>\n</div>\n<div class=\"paragraph\">\n<p>To restore the previous behavior, configure a global <strong>Project default Build Authorization</strong> setting the default authorization to that of the anonymous user.\nThis feature has been implemented in Authorize Project Plugin version 1.2.0.</p>\n</div>\n</div>\n<div class=\"sect3\">\n<h4 id=\"_remoting_work_directories\">Remoting Work Directories</h4>\n<div class=\"paragraph\">\n<p><a href=\"https://issues.jenkins.io/browse/JENKINS-44108\">JENKINS-44108</a>,\n<a href=\"https://issues.jenkins.io/browse/JENKINS-44112\">JENKINS-44112</a></p>\n</div>\n<div class=\"paragraph\">\n<p>The embedded <a href=\"/projects/remoting/\">Jenkins Remoting</a> version has been updated from 3.7 to 3.10.\nIt introduces support of work directories, which may be used by Remoting to store caches, logs and other metadata.</p>\n</div>\n<div class=\"paragraph\">\n<p>Once work directory mode is enabled, Jenkins agents start writing logs to the disk and change the default destination of the filesystem JAR Cache.\nIn Remoting this opt-in feature can be enabled using the <code>-workDir=${ROOT_DIR}</code> command-line option, but the Jenkins defines custom behavior for some agent launchers:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Java Web Start Launcher (aka <em>JNLP agent</em>)</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Old agents: Work directory needs to be enabled manually</p>\n</li>\n<li>\n<p>New agents created from Web UI: Work directory is enabled by default, work directory points to <em>Remote root directory</em> of the agent.</p>\n</li>\n<li>\n<p>New agents created from CLI/API: Behavior depends on the passed configuration file, work directory is disabled by default</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Command Launcher</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>No changes, work directory should be manually enabled in launch settings if required</p>\n</li>\n</ul>\n</div>\n</li>\n<li>\n<p>Other Launcher types (e.g. SSH Launcher)</p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>The behavior is defined in plugins, which have independent release cycle</p>\n</li>\n<li>\n<p>Follow updates in tickets linked to <a href=\"https://issues.jenkins.io/browse/JENKINS-44108\">JENKINS-44108</a></p>\n</li>\n</ul>\n</div>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>You can find more information, examples and upgrade guides in <a href=\"https://github.com/jenkinsci/remoting/blob/master/docs/workDir.md\">Jenkins Remoting documentation</a>.</p>\n</div>\n</div>","document":{"title":"Known Issue: Agent connection failures involving Jenkins controllers with undefined or non-writable home directory"},"fields":{"slug":"/2-73-1/"},"pageAttributes":{"layout":"upgrades","author":null,"tags":null,"author_name":null,"blog":null,"description":null,"github":null,"irc":null,"linkedin":null,"medium":null,"opengraph":null,"twitter":null,"authoravatar":null}},"id":"eacaf21b-ed5c-5a68-adfe-cc10be6b80fc"}},"staticQueryHashes":[],"slicesMap":{}}